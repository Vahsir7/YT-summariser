# YT-summariser

A small FastAPI app that fetches YouTube transcripts, sends them to Google Gemini (LLM) for summarization, and returns insights and a downloadable PDF.

This README covers setup, running, and troubleshooting on Windows (PowerShell). The project uses `youtube-transcript-api`, `pytube`, `fastapi`, and the Google Generative AI client.

---

## Requirements

- Python 3.10+
- A Gemini API key (set as `GEMINI_API_KEY` in `.env` or environment variable)
- PowerShell (instructions below use PowerShell syntax)

---

## Quick start (PowerShell)

Open PowerShell and run these commands from the project root `d:\coding\Codes\Projects\YT-summariser`.

1) Create and activate a virtual environment (if you haven't already):

```powershell
python -m venv .venv
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process  # only if activation is blocked
.venv\Scripts\Activate.ps1
```

2) Install dependencies:

```powershell
python -m pip install --upgrade pip
pip install -r .\requirements.txt
# If requirements.txt is missing or you want to ensure all expected packages:
# pip install fastapi uvicorn[standard] python-dotenv google-generativeai youtube-transcript-api pytube markdown2 xhtml2pdf jinja2
```

3) Configure the Gemini API key (option A: .env file, option B: session env var):

```powershell
# Option A: create a .env file in the project root
echo "GEMINI_API_KEY=your_real_api_key_here" > .env

# Option B: set in the current PowerShell session (temporary)
$env:GEMINI_API_KEY = 'your_real_api_key_here'
```

4) Run the app with uvicorn:

```powershell
uvicorn main:app --reload --host 127.0.0.1 --port 8000
```

Open http://127.0.0.1:8000/ in your browser. The auto-generated docs are at:
- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

---

## Endpoints

- `GET /` — returns the main `index.html` template.
- `POST /get-insights` — accepts JSON body `{ "video_url": "https://www.youtube.com/watch?v=..." }`. Returns `{ "title": string, "insights": string }` where `insights` is Markdown generated by Gemini.
- `POST /download-pdf` — accepts JSON body `{ "title": string, "markdown_content": string }`. Returns a PDF attachment.

Example `get-insights` call (PowerShell):

```powershell
$body = @{ video_url = 'https://www.youtube.com/watch?v=VIDEO_ID' } | ConvertTo-Json
Invoke-RestMethod -Uri http://127.0.0.1:8000/get-insights -Method Post -Body $body -ContentType 'application/json' | ConvertTo-Json -Depth 5
```

Example `download-pdf` call (PowerShell):

```powershell
$payload = @{ title = 'My Test'; markdown_content = '# Hello\nThis is a test.' } | ConvertTo-Json
Invoke-RestMethod -Uri http://127.0.0.1:8000/download-pdf -Method Post -Body $payload -ContentType 'application/json' -OutFile .\output.pdf
```

---

## Implementation notes & troubleshooting

- Transcript fetching
	- This project uses `youtube-transcript-api`. The code instantiates `YouTubeTranscriptApi()` and calls `fetch(video_id)` to obtain a `FetchedTranscript` object. The text is joined from the snippet objects.
	- Some videos won't have transcripts (manual or auto-generated). The app returns HTTP 404 in this case.
	- If YouTube blocks requests from your environment (RequestBlocked / IpBlocked exceptions), consider using proxies (see the `youtube-transcript-api` docs) or running the project from a different network.

- Gemini model
	- The app defaults to a Gemini 2.5 variant; current code uses `gemini-2.5-flash-lite` for cost/performance balance. You can change it in `main.py` to `gemini-2.5-pro` (best capability) or `gemini-2.5-flash`.
	- Ensure your API key has access to the chosen model and billing is enabled where required.

- Common errors
	- "Warning: GEMINI_API_KEY environment variable not set." — set `GEMINI_API_KEY` in `.env` or the session.
	- `pytube` title fetch failing — this can happen when YouTube changes layouts; the app falls back to a generic title if that call fails.
	- `xhtml2pdf` rendering issues — complex CSS may not render perfectly. For higher-quality PDFs consider `WeasyPrint` or `wkhtmltopdf`.

---

## Development notes

- Code files of interest:
	- `main.py` — application entrypoint and endpoints
	- `templates/index.html` — front-end UI served by the root endpoint
	- `static/` — contains front-end JS/CSS files

- To change the Gemini model, edit `main.py` and update the `GenerativeModel` argument, for example:

```python
model = genai.GenerativeModel('gemini-2.5-flash')
```

